services:
  sam2: # Container providing the dependencies of the Segment Anything Model 2 (SAM 2)
    extends: # Extend a service providing config for NVIDIA GPU(s) and in-Docker GUIs
      file: ./compose/core-compose.yaml
      service: base-nvidia-ubuntu

    build: # Command:     docker compose --progress plain build sam2
      context: ./dockerfiles/
      dockerfile: sam2.Dockerfile
      target: sam2

    image: bennedh/spot-skills:sam2

    volumes: # Mount the working directory into the container
      - .:/docker/

  glxgears-mac: # Container supporting the glxgears OpenGL demo on a macOS host
    extends: # Extend a service providing a basic CLI for Docker
      file: ./compose/core-compose.yaml
      service: base-cli

    environment:
      - DISPLAY=docker.for.mac.host.internal:0
      #- QT_X11_NO_MITSHM=1 # Prevent Qt apps in Docker from using X11's MIT-SHM extension

    build: # See the Dockerfile for full build/run instructions
      context: ./dockerfiles/
      dockerfile: glxgears-mac.Dockerfile
      target: glxgears-mac
